(this["webpackJsonpweb-scheduling"]=this["webpackJsonpweb-scheduling"]||[]).push([[17],{152:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return r}));var a=function(e){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e)};var r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30;return t/100*e}},313:function(e,t,n){},379:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return F}));var a,r,c,o=n(56),s=n(254),i=n(375),d=n(244),l=n(253),u=n(365),m=n(335),p=n(332),j=n(334),b=n(198),h=n(258),f=n(376),x=n(35),g=n(1),O=n(9),v=n(46),y=n(130),_=n(152),I=n(150),E=n.n(I),w=n(151),k=n(36),N=n(20),C=n(10),D=n(382),B=(n(313),n(314)),P=n.n(B).a.create({baseURL:"https://agendamentoweb.herokuapp.com"}),S=n(3),M=function(e){var t=e.schedules,n=e.price,a=e.userInfo,r=Object(g.useState)({cardNumber:"6062826786276634"}),c=Object(C.a)(r,2),o=c[0],s=c[1],i=Object(x.e)().setPaymentStatusDetails,d=Object(x.d)().submitSchedule;Object(g.useEffect)((function(){window.Mercadopago.clearSession(),window.Mercadopago.setPublishableKey("TEST-72a91e7b-462c-4ed6-be2c-5485b30eeb3b"),window.Mercadopago.getIdentificationTypes(),document.getElementById("description").value=l(!0)}),[]),Object(g.useEffect)((function(){!function(e){if(function(){document.getElementById("cardNumber").style.backgroundImage="",document.getElementById("issuerInput").classList.add("hidden"),document.getElementById("issuer").options.length=0,document.getElementById("installments").options.length=0}(),e.length>=6){var t=e.substring(0,6);window.Mercadopago.getPaymentMethod({bin:t},u)}}(o.cardNumber),console.log("STATE",o)}),[o.cardNumber]);var l=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=e?"Agendamento Web - ":"";return t.forEach((function(e,a){var r=e.procedure.name,c=new Date(e.selectedDate).toLocaleDateString();n+=t.length!=a+1?"".concat(r," (").concat(c,") , "):"".concat(r," (").concat(c,")")})),n};function u(e,t){if(200==e){var a=t[0];document.getElementById("paymentMethodId").value=a.id,document.getElementById("cardNumber").style.backgroundImage="url(".concat(a.thumbnail,")"),a.additional_info_needed.includes("issuer_id")?(r=a.id,window.Mercadopago.getIssuers(r,m)):(document.getElementById("issuerInput").classList.add("hidden"),p(a.id,n))}else alert("payment method info error: ".concat(t.message)),console.log("payment method info ",t);var r}function m(e,t){if(200==e){var a=document.getElementById("issuer");t.forEach((function(e){var t=document.createElement("option");t.text=e.name,t.value=e.id,a.appendChild(t)})),a.options.length<=1?document.getElementById("issuerInput").classList.add("hidden"):document.getElementById("issuerInput").classList.remove("hidden"),p(document.getElementById("paymentMethodId").value,n,a.value)}else alert("issuers method info error: ".concat(t))}function p(e,t,a){window.Mercadopago.getInstallments({payment_method_id:e,amount:n,issuer_id:a?parseInt(a):void 0},j)}function j(e,t){200==e?(document.getElementById("installments").options.length=0,t[0].payer_costs.forEach((function(e){var t=document.createElement("option");t.text=e.recommended_message,t.value=e.installments,document.getElementById("installments").appendChild(t)}))):alert("installments method info error: ".concat(t))}var b=function(){var e=Object(w.a)(E.a.mark((function e(){var n,r,c,o,s,u,m,p,j,b,h,f;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=document.getElementById("paymentMethodId").value,r=document.getElementById("installments").value,c=document.getElementById("email").value,o=document.getElementById("amount").value,s=document.getElementById("token").value,u=l(),m={email:c,description:u,installments:r,paymentMethodId:n,transactionAmount:o,token:s},p=t.map((function(e){return{procedure:{id:e.procedure.id,name:e.procedure.name,time:e.procedure.time},professional:{id:e.professional.id,name:e.professional.name,photo:e.professional.photo,price:parseFloat(e.professional.price)},scheduleDate:e.selectedDate,scheduleTime:e.selectedTime}})),e.next=10,x=m,P.post("/process_payment",x);case 10:if(!(j=e.sent).data.hasOwnProperty("status")){e.next=19;break}if("approved"!==(b=j.data.status)&&"pending"!==b){e.next=19;break}return h=a.user,e.next=17,d({userId:h.uid,userName:h.displayName,userPhoto:h.photoURL,userEmail:h.email,schedules:p,paymentInfo:j.data});case 17:f=e.sent,console.log("SALVOU?",f);case 19:i(j.data);case 20:case"end":return e.stop()}var x}),e)})));return function(){return e.apply(this,arguments)}}();function h(e,t){200==e||201==e?(document.getElementById("token").value=t.id,b()):alert("Verifique os dados inseridos!\n"+JSON.stringify(t,null,4))}return Object(S.jsx)(S.Fragment,{children:Object(S.jsx)("main",{children:Object(S.jsx)("section",{class:"payment-form dark",children:Object(S.jsxs)("div",{class:"",children:[Object(S.jsx)("div",{class:"block-heading",children:Object(S.jsx)("h2",{children:"Pagamento no cart\xe3o"})}),Object(S.jsxs)("div",{class:"form-payment",children:[Object(S.jsxs)("div",{class:"products",children:[Object(S.jsx)("h2",{class:"title",children:"Itens"}),Object(S.jsxs)("div",{class:"item",children:[Object(S.jsx)("span",{class:"price",id:"summary-price"}),Object(S.jsxs)("p",{class:"item-name",children:[Object(S.jsx)("em",{children:l()})," ",Object(S.jsx)("span",{id:"summary-quantity"})]})]}),Object(S.jsxs)("div",{class:"total",children:["Valor do pagamento",Object(S.jsx)("span",{class:"price",id:"summary-total",children:n})]})]}),Object(S.jsx)("div",{class:"payment-details",children:Object(S.jsxs)("form",{onSubmit:function(e){e.preventDefault(),function(e){e.preventDefault();var t=document.getElementById("paymentForm");window.Mercadopago.createToken(t,h)}(e)},id:"paymentForm",children:[Object(S.jsx)("h3",{class:"title",children:"Suas informa\xe7\xf5es"}),Object(S.jsx)("div",{class:"row",children:Object(S.jsxs)("div",{class:"form-group col",children:[Object(S.jsx)("label",{for:"email",children:"E-Mail"}),Object(S.jsx)(y.l,{required:!0,defaultValue:"seijiyokai@gmail.com",id:"email",name:"email",type:"text"})]})}),Object(S.jsxs)("div",{class:"row",children:[Object(S.jsx)("div",{class:"form-group col-sm-5",children:Object(S.jsx)(D.a,{native:!0,hidden:!0,inputProps:{"data-checkout":"docType"},id:"docType",name:"docType",type:"text",variant:"outlined",value:"CPF"})}),Object(S.jsxs)("div",{class:"form-group col-sm-7",children:[Object(S.jsx)("label",{for:"docNumber",children:"CPF"}),Object(S.jsx)(y.l,{required:!0,defaultValue:"76185675900",id:"docNumber",name:"docNumber",inputProps:{"data-checkout":"docNumber"},type:"text"})]})]}),Object(S.jsx)("br",{}),Object(S.jsx)("h3",{class:"title",children:"Detalhes do cart\xe3o de cr\xe9dito"}),Object(S.jsxs)("div",{class:"row",children:[Object(S.jsxs)("div",{class:"form-group col-sm-8",children:[Object(S.jsx)("label",{for:"cardholderName",children:"Nome do propriet\xe1rio do cart\xe3o"}),Object(S.jsx)(y.l,{required:!0,defaultValue:"Otimista",id:"cardholderName",name:"cardholderName",inputProps:{"data-checkout":"cardholderName"},type:"text"})]}),Object(S.jsxs)("div",{class:"form-group col-sm-4",children:[Object(S.jsx)("label",{for:"",children:"V\xe1lido at\xe9"}),Object(S.jsxs)("div",{class:"input-group expiration-date",children:[Object(S.jsx)(y.l,{required:!0,defaultValue:"12",type:"text",placeholder:"MM",id:"cardExpirationMonth",name:"cardExpirationMonth",inputProps:{"data-checkout":"cardExpirationMonth"},onselectStart:function(){return!1},onPaste:function(){return!1},onCopy:function(){return!1},onCut:function(){return!1},onDrag:function(){return!1},onDrop:function(){return!1},autoComplete:"off"}),Object(S.jsx)("span",{class:"date-separator",children:"/"}),Object(S.jsx)(y.l,{required:!0,defaultValue:"22",type:"text",placeholder:"YY",id:"cardExpirationYear",name:"cardExpirationYear",inputProps:{"data-checkout":"cardExpirationYear"},onselectStart:function(){return!1},onPaste:function(){return!1},onCopy:function(){return!1},onCut:function(){return!1},onDrag:function(){return!1},onDrop:function(){return!1},autoComplete:"off"})]})]}),Object(S.jsxs)("div",{class:"form-group col-sm-8",children:[Object(S.jsx)("label",{for:"cardNumber",children:"Numero do cart\xe3o"}),Object(S.jsx)(y.l,{required:!0,type:"text",id:"cardNumber",name:"cardNumber",onChange:function(e){var t=e.target,n=t.name,a=t.value;s((function(e){return Object(N.a)(Object(N.a)({},e),{},Object(k.a)({},n,a))}))},value:o.cardNumber,inputProps:{"data-checkout":"cardNumber",class:"input-background"},onselectStart:function(){return!1},onCopy:function(){return!1},onCut:function(){return!1},onDrag:function(){return!1},onDrop:function(){return!1},autoComplete:"off"})]}),Object(S.jsxs)("div",{class:"form-group col-sm-4",children:[Object(S.jsx)("label",{for:"securityCode",children:"CVV"}),Object(S.jsx)(y.l,{required:!0,defaultValue:"123",id:"securityCode",name:"securityCode",inputProps:{"data-checkout":"securityCode"},type:"text",onselectStart:function(){return!1},onPaste:function(){return!1},onCopy:function(){return!1},onCut:function(){return!1},onDrag:function(){return!1},onDrop:function(){return!1},autoComplete:"off"})]}),Object(S.jsxs)("div",{id:"issuerInput",class:"form-group col-sm-12 hidden",children:[Object(S.jsx)("label",{for:"issuer",children:"Issuer"}),Object(S.jsx)(D.a,{native:!0,inputProps:{"data-checkout":"issuer"},onChange:function(e){window.Mercadopago.getInstallments({payment_method_id:document.getElementById("paymentMethodId").value,amount:n,issuer_id:parseInt(document.getElementById("issuer").value)},j)},id:"issuer",name:"issuer",class:"form-control"})]}),Object(S.jsxs)("div",{class:"form-group col-sm-12",children:[Object(S.jsx)("label",{for:"installments",children:"Parcelas"}),Object(S.jsx)(D.a,{native:!0,type:"text",id:"installments",variant:"outlined"})]}),Object(S.jsxs)("div",{class:"form-group col-sm-12",children:[Object(S.jsx)("input",{type:"hidden",name:"transactionAmount",id:"amount",value:n}),Object(S.jsx)("input",{type:"hidden",name:"paymentMethodId",id:"paymentMethodId"}),Object(S.jsx)("input",{type:"hidden",name:"description",id:"description"}),Object(S.jsx)("input",{type:"hidden",name:"token",id:"token"}),Object(S.jsx)("br",{}),Object(S.jsx)("button",{type:"submit",class:"btn btn-primary btn-block",children:"Pagar"}),Object(S.jsx)("br",{})]})]})]})})]})]})})})})},V={approved:{accredited:"Pronto, seu pagamento foi aprovado! "},in_process:{pending_contingency:"N\xe3o se preocupe, em menos de 2 dias \xfateis informaremos por e-mail se foi creditado.",pending_review_manual:"N\xe3o se preocupe, em menos de 2 dias \xfateis informaremos por e-mail se foi creditado."},rejected:{cc_rejected_bad_filled_card_number:"Revise o n\xfamero do cart\xe3o.",cc_rejected_bad_filled_date:"Revise a data de vencimento.",cc_rejected_bad_filled_other:"Revise os dados.",cc_rejected_bad_filled_security_code:"Revise o c\xf3digo de seguran\xe7a do cart\xe3o.",cc_rejected_blacklist:"N\xe3o pudemos processar seu pagamento.",cc_rejected_call_for_authorize:"Voc\xea deve autorizar o pagamento do valor.",cc_rejected_card_disabled:"Ligue para a operadora do cart\xe3o para ativa-lo. O telefone est\xe1 no verso do seu cart\xe3o.",cc_rejected_card_error:"N\xe3o conseguimos processar seu pagamento.",cc_rejected_duplicated_payment:"Voc\xea j\xe1 efetuou um pagamento com esse valor. Caso precise pagar novamente, utilize outro cart\xe3o ou outra forma de pagamento.",cc_rejected_high_risk:"Seu pagamento foi recusado.",cc_rejected_insufficient_amount:"Saldo insuficiente.",cc_rejected_invalid_installments:"A operadora do seu cart\xe3o n\xe3o processa pagamentos na quantidade de parcelas selecionada",cc_rejected_max_attempts:"Voc\xea atingiu o limite de tentativas permitido. Escolha outro cart\xe3o ou outra forma de pagamento.",cc_rejected_other_reason:"N\xe3o pudemos processar seu pagamento."},4049:"O valor da transa\xe7\xe3o deve ser positivo!"};var T=Object(v.c)(b.a)(a||(a=Object(o.a)(["\n  display: flex;\n  flex-direction: row;\n  flex-grow: 1;\n  border-left: 5px solid ",";\n  margin-bottom: ","px;\n"])),(function(e){return e.theme.palette.primary.light}),(function(e){return e.theme.spacing(1)})),L=Object(v.c)(h.a)(r||(r=Object(o.a)(["\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  flex-wrap: wrap;\n  margin-top: ","px;\n  margin-bottom: ","px;\n  padding-left: ","px;\n  padding-right: ","px;\n  padding-top: 0px;\n  padding-bottom: 0px;\n\n  &&.first-card-content {\n    border-right: 2px solid #111;\n  }\n\n  &&.card-info {\n    max-width: 58%;\n  }\n\n  &&.card-action {\n    flex-grow: 1;\n    align-items: flex-end;\n    justify-content: center;\n  }\n"])),(function(e){return e.theme.spacing(1)}),(function(e){return e.theme.spacing(1)}),(function(e){return e.theme.spacing(1)}),(function(e){return e.theme.spacing(2)})),q=Object(v.c)(l.a)(c||(c=Object(o.a)(["\n  max-width: 100%;\n  width: 100%;\n"]))),F=function(e){var t=e.location,n=e.history,a=Object(x.e)(),r=a.schedules,c=a.removeScheduleFromShoppingCart,o=a.resetShoppingCart,b=a.paymentDetails,h=a.setPaymentStatusDetails,v=Object(x.c)().userInfo,I=function(){var e=0,t=0;return r.forEach((function(t){var n=parseFloat(t.professional.price);e+=n,console.log(n)})),t=.3*e,t=parseFloat(t.toFixed(2)),{total:e,payment:t,percentage:30}}();Object(g.useEffect)((function(){var e=t.pathname;document.title=e.substring(e.lastIndexOf("/")+1,e.length),0===r.length&&n.push("/")}),[]),Object(g.useEffect)((function(){console.log("CHECKOUT",b),b&&b.hasOwnProperty("status")&&(o(),alert(V[b.status][b.status_detail]),h({}),n.push(O.p)),b&&b.hasOwnProperty("cause")&&(alert(V[b.cause[0].code]),h({}))}),[b]);var E=function(e){return function(){c(e)}};return Object(S.jsx)(y.b,{children:Object(S.jsx)(s.a,{container:!0,justify:"center",children:Object(S.jsxs)(s.a,{item:!0,sm:8,lg:6,md:6,xs:12,children:[Object(S.jsx)(s.a,{container:!0,children:r.map((function(e,t){return Object(S.jsxs)(T,{children:[Object(S.jsxs)(L,{className:"first-card-content",children:[Object(S.jsx)(q,{variant:"subtitle1",children:new Date(e.selectedDate).toLocaleDateString("pt-BR",{weekday:"short"})}),Object(S.jsxs)(q,{noWrap:!0,variant:"h5",children:[new Date(e.selectedDate).getDate(),Object(S.jsxs)(q,{noWrap:!0,variant:"caption",children:[" ","de"," ",new Date(e.selectedDate).toLocaleDateString("pt-BR",{month:"short"})]})]}),Object(S.jsx)(q,{variant:"subtitle1",children:e.selectedTime})]}),Object(S.jsxs)(L,{className:"card-info",children:[Object(S.jsx)(q,{variant:"h6",noWrap:!0,children:e.procedure.name}),Object(S.jsx)(q,{variant:"subtitle1",noWrap:!0,children:e.professional.name}),Object(S.jsx)(q,{variant:"subtitle1",children:Object(_.b)(e.professional.price)})]}),Object(S.jsx)(L,{className:"card-action",children:Object(S.jsx)(i.a,{children:Object(S.jsx)(d.a,{onClick:E(e),children:Object(S.jsx)(f.a,{})})})})]},t)}))}),Object(S.jsx)(y.k,{}),Object(S.jsxs)(s.a,{item:!0,xs:12,children:[Object(S.jsx)(s.a,{container:!0,justify:"center",children:Object(S.jsx)(y.a,{to:O.q,variant:"outlined",color:"primary",children:"Adicionar outro servi\xe7o"})}),Object(S.jsx)(y.k,{}),Object(S.jsx)(s.a,{item:!0,xs:12,children:Object(S.jsxs)(s.a,{container:!0,justify:"center",children:[Object(S.jsx)(s.a,{item:!0,xs:6,children:Object(S.jsx)(l.a,{variant:"body2",noWrap:!0,children:"TOTAL"})}),Object(S.jsx)(s.a,{item:!0,xs:6,children:Object(S.jsx)(l.a,{align:"right",variant:"body2",noWrap:!0,children:Object(_.b)(I.total)})})]})}),Object(S.jsx)(s.a,{item:!0,xs:12,children:Object(S.jsxs)(s.a,{container:!0,justify:"center",children:[Object(S.jsx)(s.a,{item:!0,xs:6,children:Object(S.jsx)(l.a,{variant:"body1",noWrap:!0,children:"Voc\xea pagar\xe1"})}),Object(S.jsx)(s.a,{item:!0,xs:6,children:Object(S.jsx)(l.a,{align:"right",variant:"body1",noWrap:!0,children:Object(_.b)(I.payment)})})]})}),Object(S.jsx)(y.k,{}),Object(S.jsx)(l.a,{variant:"h5",noWrap:!0,children:"Pagamento"}),Object(S.jsx)(y.k,{}),Object(S.jsx)(u.a,{children:Object(S.jsx)(m.a,{children:Object(S.jsx)(p.a,{value:"card",checked:!0,control:Object(S.jsx)(j.a,{color:"secondary"}),label:"Cart\xe3o de cr\xe9dito"})})}),Object(S.jsx)(y.k,{}),Object(S.jsxs)(s.a,{container:!0,justify:"center",children:[Object(S.jsx)(y.h,{children:Object(S.jsx)(M,{schedules:r,price:I.payment,userInfo:v})}),Object(S.jsx)(y.k,{}),Object(S.jsx)(y.k,{})]})]})]})})})}}}]);
//# sourceMappingURL=17.cb86e5dc.chunk.js.map